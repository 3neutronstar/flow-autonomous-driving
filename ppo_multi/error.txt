Failure # 1 (occurred at 2020-07-24_09-27-55)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=25390, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=25389, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=25389, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 2 (occurred at 2020-07-24_09-31-07)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=25670, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=25722, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=25722, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 3 (occurred at 2020-07-24_09-37-06)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=25728, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=25869, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=25869, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 4 (occurred at 2020-07-24_09-41-38)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=25876, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=26110, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=26110, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 5 (occurred at 2020-07-24_09-44-40)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=26117, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=26242, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=26242, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 6 (occurred at 2020-07-24_09-48-32)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=26248, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=26385, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=26385, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 7 (occurred at 2020-07-24_09-52-46)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=26392, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=26506, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=26506, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 8 (occurred at 2020-07-24_09-59-53)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=26512, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=26671, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=26671, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 9 (occurred at 2020-07-24_10-01-31)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=26677, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=26902, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=26902, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 10 (occurred at 2020-07-24_10-08-40)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=26909, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=27024, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=27024, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 11 (occurred at 2020-07-24_10-13-00)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=27030, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=27271, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=27271, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 12 (occurred at 2020-07-24_10-16-23)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=27277, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=27397, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=27397, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 13 (occurred at 2020-07-24_10-21-31)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=27403, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=27529, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=27529, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 14 (occurred at 2020-07-24_10-24-12)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=27540, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=27678, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=27678, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 15 (occurred at 2020-07-24_10-28-30)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=27684, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=27802, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=27802, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 16 (occurred at 2020-07-24_10-32-59)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=27809, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=27939, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=27939, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 17 (occurred at 2020-07-24_10-37-03)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=27950, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=28175, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=28175, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 18 (occurred at 2020-07-24_10-41-36)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=28182, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=28356, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=28356, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 19 (occurred at 2020-07-24_10-44-14)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=28362, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=28484, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=28484, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 20 (occurred at 2020-07-24_10-49-47)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=28490, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=28694, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=28694, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 21 (occurred at 2020-07-24_10-54-03)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=28701, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=28850, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=28850, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 22 (occurred at 2020-07-24_10-57-19)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=28862, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=28973, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=28973, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 23 (occurred at 2020-07-24_11-00-59)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=28984, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=29197, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=29197, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 24 (occurred at 2020-07-24_11-03-57)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=29204, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=29344, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=29344, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 25 (occurred at 2020-07-24_11-06-41)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=29355, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=29532, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=29532, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 26 (occurred at 2020-07-24_11-10-04)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=29538, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=29660, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=29660, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 27 (occurred at 2020-07-24_11-15-35)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=29667, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=29863, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=29863, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 28 (occurred at 2020-07-24_11-16-05)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=29875, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=30003, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=30003, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 29 (occurred at 2020-07-24_11-20-00)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=30014, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=30142, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=30142, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 30 (occurred at 2020-07-24_11-24-06)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=30149, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=30385, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=30385, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 31 (occurred at 2020-07-24_11-26-56)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=30396, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=30508, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=30508, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

Failure # 32 (occurred at 2020-07-25_18-18-54)
Traceback (most recent call last):
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trial_runner.py", line 468, in _process_trial
    result = self.trial_executor.fetch_result(trial)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/ray_trial_executor.py", line 430, in fetch_result
    result = ray.get(trial_future[0], DEFAULT_GET_TIMEOUT)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/worker.py", line 1474, in get
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(TraCIException): [36mray::PPO.train()[39m (pid=30515, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 497, in train
    raise e
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer.py", line 486, in train
    result = Trainable.train(self)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/tune/trainable.py", line 261, in train
    result = self._train()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 132, in _train
    return self._train_exec_impl()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/agents/trainer_template.py", line 170, in _train_exec_impl
    res = next(self.train_exec_impl)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 731, in __next__
    return next(self.built_iterator)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 814, in apply_filter
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 847, in apply_flatten
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 799, in add_wait_hooks
    item = next(it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 744, in apply_foreach
    for item in it:
  [Previous line repeated 1 more time]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 445, in base_iterator
    yield ray.get(futures, timeout=timeout)
ray.exceptions.RayTaskError(TraCIException): [36mray::RolloutWorker.par_iter_next()[39m (pid=30654, ip=192.168.0.12)
  File "/home/bmil/flow/flow/core/kernel/vehicle/traci.py", line 1120, in add
    departSpeed=str(speed))
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1427, in add
    self._connection._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Invalid departLane definition for vehicle 'human_0_0';
 must be one of ("random", "free", "allowed", "best", "first", or an int>=0)

During handling of the above exception, another exception occurred:

[36mray::RolloutWorker.par_iter_next()[39m (pid=30654, ip=192.168.0.12)
  File "python/ray/_raylet.pyx", line 442, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 445, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 446, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 400, in ray._raylet.execute_task.function_executor
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/util/iter.py", line 1125, in par_iter_next
    return next(self.local_it)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 263, in gen_rollouts
    yield self.sample()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/rollout_worker.py", line 528, in sample
    batches = [self.input_reader.next()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 59, in next
    batches = [self.get_data()]
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 164, in get_data
    item = next(self.rollout_provider)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 489, in _env_runner
    observation_fn=observation_fn)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/evaluation/sampler.py", line 728, in _process_observations
    resetted_obs = base_env.try_reset(env_id)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 401, in try_reset
    obs = self.env_states[env_id].reset()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/ray/rllib/env/base_env.py", line 437, in reset
    self.last_obs = self.env.reset()
  File "/home/bmil/flow/flow/envs/multiagent/ring/accel.py", line 229, in reset
    return super().reset()
  File "/home/bmil/flow/flow/envs/multiagent/base.py", line 229, in reset
    self.k.kernel_api.vehicle.remove(veh_id)  # FIXME: hack
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/_vehicle.py", line 1435, in remove
    tc.CMD_SET_VEHICLE_VARIABLE, tc.REMOVE, vehID, reason)
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 143, in _sendByteCmd
    self._sendExact()
  File "/home/bmil/anaconda3/envs/flow/lib/python3.7/site-packages/traci/connection.py", line 106, in _sendExact
    raise TraCIException(err, prefix[1], _RESULTS[prefix[2]])
traci.exceptions.TraCIException: Vehicle 'human_0_0' is not known

